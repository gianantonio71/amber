syn_fn_def(
  name: fn_symbol(capitalize),
  params: [(type: type_ref(type_symbol(string)), var: var(s))],
  local_fns: [],
  expr: do_expr(
    [
      assignment_stmt(value: object(true), var: var(first)),
      assignment_stmt(value: seq_expr(head: []), var: var(res)),
      for_stmt(
        body: [
          if_stmt(
            else: [
              if_stmt(
                else: [],
                branches: [
                  (
                    cond: and(
                      left: and(
                        left: fn_call(
                          name: op_symbol(greater_eq),
                          params: [const_or_var(ch), object(97)],
                          named_params: []
                        ),
                        right: fn_call(
                          name: op_symbol(lower_eq),
                          params: [const_or_var(ch), object(122)],
                          named_params: []
                        )
                      ),
                      right: const_or_var(first)
                    ),
                    body: [
                      assignment_stmt(
                        value: fn_call(
                          name: op_symbol(minus),
                          params: [const_or_var(ch), object(32)],
                          named_params: []
                        ),
                        var: var(ch)
                      )
                    ]
                  )
                ]
              ),
              assignment_stmt(value: object(false), var: var(first))
            ],
            branches: [
              (
                cond: eq(left: const_or_var(ch), right: object(95)),
                body: [assignment_stmt(value: object(true), var: var(first))]
              )
            ]
          ),
          assignment_stmt(
            value: fn_call(
              name: op_symbol(amp),
              params: [const_or_var(res), seq_expr(head: [const_or_var(ch)])],
              named_params: []
            ),
            var: var(res)
          )
        ],
        loops: [
          seq_iter(
            var: var(ch),
            values: fn_call(
              name: fn_symbol(untag),
              params: [const_or_var(s)],
              named_params: []
            ),
            idx_var: var(i)
          )
        ]
      ),
      return_stmt(
        fn_call(
          name: fn_symbol(string),
          params: [const_or_var(res)],
          named_params: []
        )
      )
    ]
  ),
  res_type: type_ref(type_symbol(string))
)
