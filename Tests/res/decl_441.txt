syn_fn_def(
  name: fn_symbol(new_vars),
  params: [(type: type_ref(type_symbol(clause)), var: var(clause))],
  local_fns: [],
  expr: match_expr(
    cases: [
      case(
        expr: fn_call(
          name: fn_symbol(new_vars),
          params: [accessor(expr: const_or_var(clause), field: object(ptrn))],
          named_params: []
        ),
        patterns: [
          tag_ptrn(obj: type_ptrn(type_any), tag: obj_ptrn(object(in_clause)))
        ]
      ),
      case(
        expr: set_expr({}),
        patterns: [
          tag_ptrn(
            obj: type_ptrn(type_any),
            tag: obj_ptrn(object(not_in_clause))
          )
        ]
      ),
      case(
        expr: fn_call(
          name: op_symbol(amp),
          params: [
            fn_call(
              name: fn_symbol(new_vars),
              params: [
                accessor(expr: const_or_var(clause), field: object(key_ptrn))
              ],
              named_params: []
            ),
            fn_call(
              name: fn_symbol(new_vars),
              params: [
                accessor(expr: const_or_var(clause), field: object(value_ptrn))
              ],
              named_params: []
            )
          ],
          named_params: []
        ),
        patterns: [
          tag_ptrn(
            obj: type_ptrn(type_any),
            tag: obj_ptrn(object(map_in_clause))
          )
        ]
      ),
      case(
        expr: set_expr({}),
        patterns: [
          tag_ptrn(
            obj: type_ptrn(type_any),
            tag: obj_ptrn(object(map_not_in_clause))
          )
        ]
      ),
      case(
        expr: fn_call(
          name: op_symbol(amp),
          params: [
            fn_call(
              name: fn_symbol(new_vars),
              params: [accessor(expr: const_or_var(clause), field: object(left))],
              named_params: []
            ),
            fn_call(
              name: fn_symbol(new_vars),
              params: [accessor(expr: const_or_var(clause), field: object(right))],
              named_params: []
            )
          ],
          named_params: []
        ),
        patterns: [
          tag_ptrn(
            obj: type_ptrn(type_any),
            tag: obj_ptrn(object(and_clause))
          )
        ]
      ),
      case(
        expr: fn_call(
          name: fn_symbol(intersection),
          params: [
            fn_call(
              name: fn_symbol(new_vars),
              params: [accessor(expr: const_or_var(clause), field: object(left))],
              named_params: []
            ),
            fn_call(
              name: fn_symbol(new_vars),
              params: [accessor(expr: const_or_var(clause), field: object(right))],
              named_params: []
            )
          ],
          named_params: []
        ),
        patterns: [
          tag_ptrn(obj: type_ptrn(type_any), tag: obj_ptrn(object(or_clause)))
        ]
      )
    ],
    exprs: [fn_par(0)]
  ),
  res_type: set_type(nonempty: false, elem_type: type_ref(type_symbol(var)))
)
