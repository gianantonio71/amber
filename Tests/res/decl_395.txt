syn_fn_def(
  name: fn_symbol(untyped_sgn),
  params: [
    (
      type: union_type(
        {
          tag_type(
            obj_type: type_ref(type_symbol(atom)),
            tag_type: symb_type(object(named_par))
          )
        }
      ),
      var: var(var)
    ),
    (type: type_ref(type_symbol(exttype)), var: var(type))
  ],
  local_fns: [],
  expr: match_expr(
    cases: [
      case(
        expr: tag_obj_expr(
          obj: map_expr(
            {
              (value: object(0), key: object(arity)),
              (
                value: tag_obj_expr(obj: const_or_var(a), tag: object(fn_symbol)),
                key: object(name)
              )
            }
          ),
          tag: object(untyped_sgn)
        ),
        patterns: [
          tag_ptrn(
            obj: var_ptrn(name: var(a)),
            tag: obj_ptrn(object(named_par))
          ),
          type_ptrn(type_ref(type_symbol(type)))
        ]
      ),
      case(
        expr: tag_obj_expr(
          obj: map_expr(
            {
              (
                value: tag_obj_expr(obj: const_or_var(a), tag: object(fn_symbol)),
                key: object(name)
              ),
              (
                value: fn_call(
                  name: fn_symbol(length),
                  params: [
                    accessor(expr: const_or_var(type), field: object(in_types))
                  ],
                  named_params: []
                ),
                key: object(arity)
              )
            }
          ),
          tag: object(untyped_sgn)
        ),
        patterns: [
          tag_ptrn(
            obj: var_ptrn(name: var(a)),
            tag: obj_ptrn(object(named_par))
          ),
          type_ptrn(type_ref(type_symbol(clstype)))
        ]
      )
    ],
    exprs: [fn_par(0), fn_par(1)]
  ),
  res_type: type_ref(type_symbol(basicuntypedsgn))
)
