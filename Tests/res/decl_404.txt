syn_fn_def(
  name: fn_symbol(is_def),
  params: [
    (type: type_ref(type_symbol(fnsymbol)), var: var(name)),
    (type: type_ref(type_symbol(nat)), var: var(arity)),
    (
      type: set_type(
        nonempty: false,
        elem_type: type_ref(type_symbol(untypedsgn))
      ),
      var: var(env)
    ),
    (
      type: set_type(
        nonempty: false,
        elem_type: type_ref(type_symbol(basicuntypedsgn))
      ),
      var: var(actual_named_params)
    )
  ],
  local_fns: [
    syn_fn_def(
      name: fn_symbol(could_match),
      params: [
        (type: type_ref(type_symbol(fnsymbol)), var: var(name)),
        (type: type_ref(type_symbol(nat)), var: var(arity)),
        (type: type_ref(type_symbol(untypedsgn)), var: var(sgn)),
        (
          type: set_type(
            nonempty: false,
            elem_type: type_ref(type_symbol(basicuntypedsgn))
          ),
          var: var(actual_named_params)
        )
      ],
      local_fns: [],
      expr: do_expr(
        [
          if_stmt(
            else: [],
            branches: [
              (
                cond: or(
                  left: neq(
                    left: accessor(expr: const_or_var(sgn), field: object(name)),
                    right: const_or_var(name)
                  ),
                  right: neq(
                    left: accessor(expr: const_or_var(sgn), field: object(arity)),
                    right: const_or_var(arity)
                  )
                ),
                body: [return_stmt(object(false))]
              )
            ]
          ),
          assignment_stmt(
            value: if_expr(
              else: set_expr({}),
              branches: [
                (
                  expr: accessor(expr: const_or_var(sgn), field: object(named_params)),
                  cond: accessor_test(expr: const_or_var(sgn), field: object(named_params))
                )
              ]
            ),
            var: var(formal_named_params)
          ),
          return_stmt(
            fn_call(
              name: fn_symbol(subset),
              params: [
                const_or_var(formal_named_params),
                const_or_var(actual_named_params)
              ],
              named_params: []
            )
          )
        ]
      ),
      res_type: type_ref(type_symbol(bool))
    )
  ],
  expr: do_expr(
    [
      return_stmt(
        ex_qual(
          sel_exprs: [
            fn_call(
              name: fn_symbol(could_match),
              params: [
                const_or_var(name),
                const_or_var(arity),
                const_or_var(sgn),
                const_or_var(actual_named_params)
              ],
              named_params: []
            )
          ],
          source: [
            in_clause(src: const_or_var(env), ptrn: var_ptrn(name: var(sgn)))
          ]
        )
      )
    ]
  ),
  res_type: type_ref(type_symbol(bool))
)
